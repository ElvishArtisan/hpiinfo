## padpoint.spec.in
##
##    PadPoint Program Associated Data Processor
##    Copyright (C) 2012  Fred Gleason <fredg@paravelsystems.com>
##
##      $Id: padpoint.spec.in,v 1.1 2012/08/23 23:25:21 pcvs Exp $
##
##    All Rights Reserved.
##

Summary: Program Associated Data Processor
Name: padpoint
Version: @VERSION@
Release: @RPM_RELEASE@%{?dist}
License: Proprietary
Packager: Fred Gleason <fredg@paravelsystems.com>
Group: Productivity/Multimedia/Other
Source: padpoint-@VERSION@.tar.gz
BuildRoot: /var/tmp/padpoint-@VERSION@

%description
PadPoint is a processor for modifying and distributing Program Associated
Data (PAD).

%prep


%setup


%build
./configure --prefix=@LOCAL_PREFIX@
make


%install
rm -rf $RPM_BUILD_ROOT

mkdir -p $RPM_BUILD_ROOT%{_libdir}
cp lib/.libs/libpadpoint-@VERSION@.so $RPM_BUILD_ROOT%{_libdir}/
ln -s %{_libdir}/libpadpoint-@VERSION@.so $RPM_BUILD_ROOT%{_libdir}/libpadpoint.so

mkdir -p $RPM_BUILD_ROOT%{_sbindir}
cp padpoint/.libs/padpoint $RPM_BUILD_ROOT%{_sbindir}/

mkdir -p $RPM_BUILD_ROOT%{_sbindir}
cp padpointd/.libs/padpointd $RPM_BUILD_ROOT%{_sbindir}/

mkdir -p $RPM_BUILD_ROOT/etc/init.d
cp rc.padpointd $RPM_BUILD_ROOT/etc/init.d/padpointd

mkdir -p $RPM_BUILD_ROOT@prefix@/share/icons/hicolor/16x16/apps
cp icons/padpoint-16x16.png $RPM_BUILD_ROOT@LOCAL_PREFIX@/share/icons/hicolor/16x16/apps/padpoint.png
mkdir -p $RPM_BUILD_ROOT@prefix@/share/icons/hicolor/22x22/apps
cp icons/padpoint-22x22.png $RPM_BUILD_ROOT@prefix@/share/icons/hicolor/22x22/apps/padpoint.png
mkdir -p $RPM_BUILD_ROOT@prefix@/share/icons/hicolor/32x32/apps
cp icons/padpoint-32x32.png $RPM_BUILD_ROOT@prefix@/share/icons/hicolor/32x32/apps/padpoint.png
mkdir -p $RPM_BUILD_ROOT@prefix@/share/icons/hicolor/48x48/apps
cp icons/padpoint-48x48.png $RPM_BUILD_ROOT@prefix@/share/icons/hicolor/48x48/apps/padpoint.png

mkdir -p $RPM_BUILD_ROOT@prefix@/share/applications
cp xdg/padpoint_padpoint.desktop $RPM_BUILD_ROOT@prefix@/share/applications/
mkdir -p $RPM_BUILD_ROOT/etc/pam.d
cp xdg/padpoint-root-pam $RPM_BUILD_ROOT/etc/pam.d/padpoint-root
mkdir -p $RPM_BUILD_ROOT/etc/security/console.apps
cp xdg/padpoint-root-consolehelper $RPM_BUILD_ROOT/etc/security/console.apps/padpoint-root
ln -s /usr/bin/consolehelper $RPM_BUILD_ROOT%{_sbindir}/padpoint-root

%post
ldconfig
if test "@DISTRO@" = "suse" ; then
  PACKAGE_DOC_DIR=%_docdir/%{name}
fi
if test "@DISTRO@" = "redhat" ; then
  PACKAGE_DOC_DIR=%_docdir/%{name}-@VERSION@
fi
if test ! -e /etc/padpoint.conf ; then
  cp $PACKAGE_DOC_DIR/padpoint.conf-sample /etc/padpoint.conf
fi
/etc/init.d/padpointd restart
if test "@DISTRO@" = "redhat" ; then
  chkconfig --add padpointd
  chkconfig --levels 2345 padpointd on
fi
exit 0

%preun
if test "$1" = "0" ; then
  /etc/init.d/padpointd stop
  if test "@DISTRO@" = "suse" ; then
    insserv -r -d -f /etc/init.d/padpointd
  fi
  if test "@DISTRO@" = "redhat" ; then
    chkconfig --levels 2345 padpointd off
    chkconfig --del padpointd
  fi
fi
exit 0

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
%{_libdir}/libpadpoint-@VERSION@.so
%{_libdir}/libpadpoint.so
%{_sbindir}/padpoint
%{_sbindir}/padpoint-root
%{_sbindir}/padpointd
/etc/init.d/padpointd
@prefix@/share/icons/hicolor/16x16/apps/padpoint.png
@prefix@/share/icons/hicolor/22x22/apps/padpoint.png
@prefix@/share/icons/hicolor/32x32/apps/padpoint.png
@prefix@/share/icons/hicolor/48x48/apps/padpoint.png
@prefix@/share/applications/padpoint_padpoint.desktop
/etc/pam.d/padpoint-root
/etc/security/console.apps/padpoint-root

%doc AUTHORS
%doc ChangeLog
%doc COPYING 
%doc docs/DESTINATIONS.txt
%doc INSTALL 
%doc NEWS 
%doc README 
%doc docs/PadPoint.lua
%doc docs/SOURCES.txt
%doc padpoint.conf-sample

%changelog
* @RPM_DATESTAMP@ Fred Gleason <fredg@paravelsystems.com> - @VERSION@-@RPM_RELEASE@
-- Autogenerated from build tree.
